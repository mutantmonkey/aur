From 3031a5607a1659cd38e876004007e1a56ace50f8 Mon Sep 17 00:00:00 2001
From: Jacob Appelbaum <jacob@appelbaum.net>
Date: Mon, 21 Mar 2016 13:33:07 +0000
Subject: [PATCH] disable ASAN by default for release builds

---
 hardened.pri | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/hardened.pri b/hardened.pri
index 1b6c3b0..1bd3aaf 100644
--- a/hardened.pri
+++ b/hardened.pri
@@ -15,12 +15,13 @@ HARDENED_STACK_PROTECTOR_FLAGS = -fstack-protector --param=ssp-buffer-size=4
 
 HARDENED_MINGW_64ASLR_FLAGS = -Wl,--dynamicbase -Wl,--high-entropy-va
 
+
 # Run tests and apply options where possible
 CONFIG(hardened) {
     # mingw is always PIC, and complains about the flag
     !mingw:HARDEN_FLAGS = -fPIC
 
-    qtCompileTest(sanitize):HARDEN_FLAGS += $$HARDENED_SANITIZE_FLAGS
+    CONFIG(debug,debug|release): qtCompileTest(sanitize):HARDEN_FLAGS += $$HARDENED_SANITIZE_FLAGS
     qtCompileTest(sanitize-ubsan):HARDEN_FLAGS += $$HARDENED_SANITIZE_UBSAN_FLAGS
     qtCompileTest(sanitize-ubsan-more):HARDEN_FLAGS += $$HARDENED_SANITIZE_UBSAN_MORE_FLAGS
     qtCompileTest(vtable-verify):HARDEN_FLAGS += $$HARDENED_VTABLE_VERIFY_FLAGS
-- 
2.8.0

